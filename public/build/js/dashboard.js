function loadBookmakersOnDashboard(){$.ajax({url:"comptes",type:"get",success:function(e){$("#comptes_par_bookmakers").html(e)},error:function(e){console.log("la récuperation des comptes bookmakers vers le dashboard n'a pas fonctionné")}})}function loadRecapsOnDashboard(){$.ajax({url:"recaps",type:"get",success:function(e){$('[data-toggle="collapse"]').collapse(),$("#recaps").html(e)},error:function(){}})}function totalProfits(){$.getJSON("totalprofit",function(e){var a=$(".dashboard-stat2");a.find(".totalprofit").text(e.montantprofit),a.find(".roi").text($.isNumeric(e.roi)?e.roi+" %":e.roi),a.find(".roi-bar").css("width",e.roi)})}function automaticBetForm(){function e(){i.submit(function(e){e.preventDefault();var r=$(this).serialize(),t=i.find(".betline").length;if(""==t)swal({title:"Erreur!",text:"Ajoutez au moins une selection pour pouvoir valider le ticket!",type:"warning",confirmButtonText:"OK"});else if(t>=1){var o,n,d;o=i.find("#ticketABCD").is(":checked")?1:0,n=i.find("#ticketGratuit").is(":checked")?1:0,d=i.find("#ticketLongTerme").is(":checked")?1:0,$.ajax({url:"encourspari/auto",type:"post",data:r+"&linesnum="+t+"&ticketABCD="+o+"&ticketGratuit="+n+"&ticketLongTerme="+d,dataType:"json",success:function(e){var r;if(0==e.etat)if($.isArray(e.msg))for(key in e.msg)r=key,toastr.error(e.msg[r],"Erreur:");else toastr.error(e.msg,"Erreur:");else 1==e.etat&&(s(),a(),toastr.success(e.msg,"Pari"),loadParisEnCours(),loadBookmakersOnDashboard())},error:function(e){console.log("erreur ajout de pari")}})}})}function a(){var e=i.find("#followtypeinputdashboard").val();$.ajax({url:"selections",success:function(a){i.find("#automatic-selections").html(a.vue),r(),$.ajax({url:"allbookmakers",dataType:"json",success:function(r){i.find(".bookinputdashboard").select2({minimumResultsForSearch:1/0,cache:!0,data:r}),"à blanc"==e?(i.find(".bookinputdashboard").val("").trigger("change"),i.find("#accountsinputdashboard").val("").trigger("change")):(i.find(".bookinputdashboard").prop("disabled",!1),i.find("#accountsinputdashboard").prop("disabled",!1),i.find(".bookinputdashboard").val(a.bookmaker_id).trigger("change")),n(a.bookmaker_id)}}),a.msg.length>0&&swal({title:"Erreur!",text:a.msg,type:"warning",confirmButtonText:"OK"})},error:function(e){i.find("#automatic-selections").html("<p>impossible de récuperer les selections</p>")}})}function r(){i.find("#automatic-selections .boutonsupprimer").on("click",function(e){e.preventDefault();var r=$(this).parents("tr"),t=r.find(".selection_id").text();$.ajax({url:"coupon/"+t,method:"delete",success:function(e){a(),i.find(".bookinputdashboard").val(null).trigger("change"),i.find('select[name="accountsinputdashboard"]').val(null).trigger("change")},error:function(e){}})})}function t(){i.find("#selection-refresh").click(function(e){e.preventDefault(),a()})}function o(){var e=i.find("select[name=typestakeinputdashboard]");i.find(".typestakeflat").hide(),e.on("change",function(){"f"==$(this).val()?(i.find(".typestakeunites").hide(),i.find("#stakeunitinputdashboard").val(""),i.find(".typestakeflat").show()):(i.find(".typestakeunites").show(),i.find(".typestakeflat").hide(),i.find("#amountinputdashboard").val(""))})}function n(e){i.find("#tipstersinputdashboard").select2({allowClear:!0,placeholder:"Choisir un tipster",cache:!0,ajax:{url:"tipsters",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}),i.find("#tipstersinputdashboard").change(function(){var a=$(d+" #tipstersinputdashboard").val(),r=$(d+" #followtypeinputdashboard"),t=$(d+" #amountperunit");$(d+" #stakeunitinputdashboard").val(""),$(d+" #amountperunit").val(""),$(d+" #amountconversion").val("0"),$(d+" #amountinputdashboard").val(""),$(d+" #flattounitconversion").val("0"),$.ajax({url:"infosTipster",data:"tipster_id="+a,dataType:"json",success:function(a){i.find(".bookinputdashboard").val(null).trigger("change"),i.find("#accountsinputdashboard").val(null).trigger("change"),r.val(""),"n"==a.followtype?(r.val("normal"),i.find(".bookinputdashboard").prop("disabled",!1),i.find("#accountsinputdashboard").prop("disabled",!1),i.find(".bookinputdashboard").val(e).trigger("change"),i.find("#accountsinputdashboard").val(null).trigger("change")):"b"==a.followtype?(r.val("à blanc"),i.find(".bookinputdashboard").val(null).trigger("change"),i.find("#accountsinputdashboard").val(null).trigger("change"),i.find(".bookinputdashboard").prop("disabled",!0),i.find("#accountsinputdashboard").prop("disabled",!0)):(i.find(".bookinputdashboard").prop("disabled",!1),i.find("#accountsinputdashboard").prop("disabled",!1),i.find(".bookinputdashboard").val(e).trigger("change"),i.find("#accountsinputdashboard").val(null).trigger("change"));var o=Number(a.montant_par_unite);t.val(isNaN(o)?"":o)}})})}function s(){i.find("#stakeunitinputdashboard").val(null).trigger("change"),i.find("#amountinputdashboard").val(null).trigger("change"),i.find("#accountsinputdashboard").val(null).trigger("change"),i.find("input:checkbox").prop("checked",!1)}var i=$("#automaticform-add"),d="#automaticform-add",l=[{id:"u",text:"en unités"},{id:"f",text:"en devise"}];i.find("#typestakeinputdashboard").select2({minimumResultsForSearch:1/0,cache:!0,data:l}),i.find("#accountsinputdashboard").select2({allowClear:!0,placeholder:"Choisir un compte",cache:!0,minimumResultsForSearch:1/0,ajax:{url:"accounts",dataType:"json",data:function(e){return{book_id:$(d+" .bookinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}}),i.find("#serieinputdashboard").select2({allowClear:!0,placeholder:"Choisir une serie",tags:!0,cache:!0,ajax:{url:"parisabcd",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}),i.find("#letterinputdashboard").select2({allowClear:!0,placeholder:"Choisir une lettre",cache:!0,minimumResultsForSearch:1/0,ajax:{url:"lettreabcd",dataType:"json",data:function(e){return{serie_nom:$(d+" #serieinputdashboard").val(),q:e.term}},processResults:function(e){console.log(e);var a=[];return $.each(e,function(e,r){a.push({id:r,text:r})}),{results:a}}}}),i.find("#stakeunitinputdashboard").keyup(function(){var e=$(d+" #amountperunit").val(),a=Number($(d+" #stakeunitinputdashboard").val()),r=Number(e)*Number(a),t=Math.round(100*r)/100;isNaN(t)||0>t?$(d+"#amountconversion").val("0"):$(d+" #amountconversion").val(t)}),i.find("#amountinputdashboard").keyup(function(){var e=$(d+" #amountperunit").val(),a=$(d+" #amountinputdashboard").val(),r=Number(a)/Number(e),t=Math.round(100*r)/100;$(d+" #flattounitconversion").val(isNaN(t)||0>t||""==e?"0":t)}),i.find("#serieinputdashboard").prop("disabled",!0),i.find("#letterinputdashboard").prop("disabled",!0),i.find(".methodeabcdcontainer").addClass("hide"),i.find("#ticketABCD").on("click",function(){$(this).is(":checked")?(i.find(".methodeabcdcontainer").removeClass("hide"),i.find("#serieinputdashboard").prop("disabled",!1),i.find("#letterinputdashboard").prop("disabled",!1)):(i.find(".methodeabcdcontainer").addClass("hide"),i.find("#serieinputdashboard").prop("disabled",!0),i.find("#letterinputdashboard").prop("disabled",!0))}),t(),a(),e(),o()}function loadParisABCD(){$.ajax({url:"dashboard/ajax/parisabcd",data:{page:1},type:"get",success:function(e){$("#tab_15_3").html(e)},error:function(e){$("#tab_15_3").html("<p>impossible de récuperer les paris ABCD</p>")}})}function loadParisEnCours(){$("#onglet_paris_en_cours span");$.ajax({url:"dashboard/ajax/parisencours",data:{page:1},type:"get",success:function(e){$("#tab_15_1").html(e.vue);var a=e.count_paris_encours;0==a?$("#onglet_paris_en_cours span").text(""):$("#onglet_paris_en_cours span").html(a),featuresParisEnCours(),paginationParisEnCours(),totalProfits(),cashOut()},error:function(e){$("#tab_15_1").html("<p>impossible de récuperer les paris</p>")}})}function loadParisTermine(){$("#onglet_paris_long_terme span");$.ajax({url:"dashboard/ajax/paristermine",data:{page:1},type:"get",success:function(e){$("#tab_15_4").html(e),parisTermineDelete(),$("#paristerminetable .boutonsupprimer").click(function(e){e.stopPropagation()}),$(function(){$(".slimScrollTermine").slimScroll({height:"150px",allowPageScroll:!1,wheelStep:10,alwaysVisible:!0})})},error:function(e){$("#tab_15_4").html("<p>impossible de récuperer les paris terminés</p>")}})}function featuresParisEnCours(){$('[data-toggle="tooltip"]').tooltip(),$("[data-hover='tooltip']").tooltip(),$("#parisencourstable .boutonvalider").click(function(e){e.stopPropagation()}),$("#parisencourstable .boutonsupprimer").click(function(e){e.stopPropagation()}),$("select[name='resultatDashboardInput']").click(function(e){e.stopPropagation()}),parisEnCoursCalculateStatus("#parisencourstable"),parisEnCoursEnclose("#parisencourstable",".validerform","historique"),parisEnCoursDelete("#parisencourstable",".supprimerform","encourspari/")}function paginationParisEnCours(){$("#tab_15_1").on("click",".pagination a",function(e){e.preventDefault();var a=getPaginationSelectedPage($(this).attr("href"));$.ajax({url:"dashboard/ajax/parisencours",data:{page:a},success:function(e){$("#tab_15_1").html(e),featuresParisEnCours()},error:function(e){console.log("erreur: pagination par click")}})})}function loadParisEnCoursWithPage(e){var a=$("#parisencourstable .id").length,r=$("#tab_15_1").find(".active").find("span").text();"delete"==e&&1==a&&(r-=1),r?$.ajax({url:"dashboard/ajax/parisencours",data:{page:r},type:"get",success:function(e){$("#tab_15_1").html(e),featuresParisEnCours()}}):loadParisEnCours()}function cashOut(){$("#cashoutModal").on("show.bs.modal",function(e){var a=$(e.relatedTarget).data("id");$(e.currentTarget).find('input[name="pari-id"]').val(a)});var e=$("#cashout-update"),a=[{id:"c",text:"classic cash out"}];e.find("#cashout-select").select2({minimumResultsForSearch:1/0,cache:!0,data:a}).change(function(){e.find(".classic-cash-out-group").toggleClass("hide")}),e.submit(function(a){a.preventDefault();var r=e.serialize();$.ajax({url:"cashout",type:"post",data:r,dataType:"json",success:function(e){if(e.etat)toastr.success(e.msg,"Pari");else for(key in e.msg)keyname=key,toastr.error(e.msg[keyname],"Erreur:")},error:function(){}})})}function loadParisLongTerme(){$.ajax({url:"dashboard/ajax/parislongterme",data:{page:"1"},type:"get",success:function(e){$("#tab_15_2").html(e),$('[data-toggle="tooltip"]').tooltip(),$("#onglet_paris_long_terme span").text($("#parislongtermetable #count").text());{var a=($("#parislongtermetable"),$("#parislongtermetable .boutonvalider")),r=$("#parislongtermetable .boutonsupprimer"),t=$("#parislongtermetable .validerform"),o=$("#parislongtermetable .supprimerform"),n=$("#parislongtermetable select[name='resultatDashboardInput']");$("#parislongtermetable select[name='resultatDashboardInput'] option:selected")}$('[data-toggle="tooltip"]').tooltip(),a.click(function(e){e.stopPropagation()}),r.click(function(e){e.stopPropagation()}),n.click(function(e){e.stopPropagation()}),n.change(function(e){var a=$(this).closest(".mainrow"),r=a.find(".tdcote").text(),t=a.find(".tdmise .tdsubmise").text(),o=a.find(".tdretour span.subretour"),n=a.find(".tdretour");switch(result=a.find("select[name='resultatDashboardInput'] option:selected").text()){case"--Selectionnez--":o.empty(),n.css("color","black");break;case"Gagné":var s=parseFloat(t*r);n.css("color","green"),a.find(".tdretour span.subretour").text(s);break;case"Perdu":var s=parseFloat(t);n.css("color","red"),a.find(".tdretour span.subretour").text(s);break;case"1/2 Gagné":var s=parseFloat((t*r-t)/2)+parseFloat(t);n.css("color","green"),a.find(".tdretour span.subretour").text(s);break;case"1/2 Perdu":var s=parseFloat(t/2);n.css("color","red"),a.find(".tdretour span.subretour").text(s);break;case"Remboursé":n.css("color","black");var s=parseFloat(t);a.find(".tdretour span.subretour").text(s);break;case"Annulé":n.css("color","black");var s=parseFloat(t);a.find(".tdretour span.subretour").text(s)}}),t.submit(function(e){e.preventDefault();var a=$(this).closest(".mainrow"),r=a.find(".tdretour span.subretour");if(r.text().length>0){var t=a.find(".tdcote").text(),o=a.find(".tdmise .tdsubmise").text(),n=$(this).serialize();$.ajax({url:"historique",type:"post",data:n+"&cote="+t+"&mise="+o+"&retour="+r,success:function(e){loadParisLongTerme()},error:function(){console.log("valider un pari long terme ne fonctionne pas")}})}else alert("Vous devez préciser un status pour ce pari.")}),o.submit(function(e){e.preventDefault();{var a=$(this).closest(".mainrow"),r=a.find(".id").text();a.find(".tdretour span.subretour"),a.find(".tdcote").text(),a.find(".tdmise .tdsubmise").text(),$(this).serialize()}confirm("Etes vous sur?")&&$.ajax({url:"historique/"+r,type:"delete",success:function(e){loadParisLongTerme()},error:function(){console.log("supprimer un pari long terme ne fonctionne pas")}})})},error:function(e){console.log("le chargement des paris long terme n'a pas fonctionné")}})}function manualBetForm(){function e(){G.addClass("hidden"),F.addClass("hidden"),W.addClass("hidden"),Z.addClass("hidden"),re.addClass("hidden"),ne.addClass("hidden"),ge.addClass("hidden"),he.prop("disabled",!0)}function a(){v.find("#automatic-selections .boutonsupprimer").on("click",function(e){e.preventDefault();var a=$(this).parents("tr"),t=a.find(".selection_id").text();$.ajax({url:"coupon/"+t,method:"delete",success:function(e){r(),v.find(".bookinputdashboard").val(null).trigger("change"),v.find('select[name="accountsinputdashboard"]').val(null).trigger("change")},error:function(e){}})})}function r(){var e=v.find("#followtypeinputdashboard").val();$.ajax({url:"selections",success:function(r){v.find("#automatic-selections").html(r.vue),a(),$.ajax({url:"allbookmakers",dataType:"json",success:function(a){v.find(".bookinputdashboard").select2({minimumResultsForSearch:1/0,cache:!0,data:a}),"à blanc"==e?(v.find(".bookinputdashboard").val("").trigger("change"),v.find("#accountsinputdashboard").val("").trigger("change")):(v.find(".bookinputdashboard").prop("disabled",!1),v.find("#accountsinputdashboard").prop("disabled",!1),v.find(".bookinputdashboard").val(r.bookmaker_id).trigger("change")),o(r.bookmaker_id)}}),r.msg.length>0&&swal({title:"Erreur!",text:r.msg,type:"warning",confirmButtonText:"OK"})},error:function(e){v.find("#automatic-selections").html("<p>impossible de récuperer les selections</p>")}})}function t(){fe.click(function(){ge.toggleClass("hidden"),fe.is(":checked")?he.prop("disabled",!1):he.prop("disabled",!0)})}function o(){v.find("#tipstersinputdashboard").select2({allowClear:!0,placeholder:"Choisir un tipster",cache:!0,ajax:{url:"tipsters",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}),v.find("#tipstersinputdashboard").change(function(){var e=$(k+" #tipstersinputdashboard").val(),a=$(k+" #followtypeinputdashboard"),r=$(k+" #amountperunit");$(k+" #stakeunitinputdashboard").val(""),$(k+" #amountperunit").val(""),$(k+" #amountconversion").val("0"),$(k+" #amountinputdashboard").val(""),$(k+" #flattounitconversion").val("0"),$.ajax({url:"infosTipster",data:"tipster_id="+e,dataType:"json",success:function(e){v.find(".bookinputdashboard").val(null).trigger("change"),v.find("#accountsinputdashboard").val(null).trigger("change"),a.val(""),"n"==e.followtype?(a.val("normal"),v.find(".bookinputdashboard").prop("disabled",!1),v.find("#accountsinputdashboard").prop("disabled",!1)):"b"==e.followtype?(a.val("à blanc"),v.find(".bookinputdashboard").val(null).trigger("change"),v.find("#accountsinputdashboard").val(null).trigger("change"),v.find(".bookinputdashboard").prop("disabled",!0),v.find("#accountsinputdashboard").prop("disabled",!0)):(v.find(".bookinputdashboard").val(null).trigger("change"),v.find("#accountsinputdashboard").val(null).trigger("change"),v.find(".bookinputdashboard").prop("disabled",!0),v.find("#accountsinputdashboard").prop("disabled",!0));var t=Number(e.montant_par_unite);r.val(isNaN(t)?"":t)},error:function(e){}})})}function n(){var e=[{id:"u",text:"en unités"},{id:"f",text:"en devise"}];v.find("#typestakeinputdashboard").select2({minimumResultsForSearch:1/0,cache:!0,data:e});var a=v.find("select[name=typestakeinputdashboard]");v.find(".typestakeflat").hide(),a.on("change",function(){"f"==$(this).val()?(v.find(".typestakeunites").hide(),v.find("#stakeunitinputdashboard").val(""),v.find(".typestakeflat").show()):(v.find(".typestakeunites").show(),v.find(".typestakeflat").hide(),v.find("#amountinputdashboard").val(""))}),v.find("#stakeunitinputdashboard").keyup(function(){var e=$(k+" #amountperunit").val(),a=Number($(k+" #stakeunitinputdashboard").val()),r=Number(e)*Number(a),t=Math.round(100*r)/100;isNaN(t)||0>t?$(k+"#amountconversion").val("0"):$(k+" #amountconversion").val(t)}),v.find("#amountinputdashboard").keyup(function(){var e=$(k+" #amountperunit").val(),a=$(k+" #amountinputdashboard").val(),r=Number(a)/Number(e),t=Math.round(100*r)/100;$(k+" #flattounitconversion").val(isNaN(t)||0>t||""==e?"0":t)})}function s(){v.find(".bookinputdashboard").select2({allowClear:!0,placeholder:"Choisir un bookmaker",cache:!0,ajax:{url:"bookmakers",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}),v.find("#accountsinputdashboard").select2({allowClear:!0,placeholder:"Choisir un compte",cache:!0,minimumResultsForSearch:1/0,ajax:{url:"accounts",dataType:"json",data:function(e){return{book_id:$(k+" .bookinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}})}function i(){v.find("#ticketABCD").on("click",function(){$(this).is(":checked")?(v.find("#methodeabcdcontainer").removeClass("hide"),v.find("#serieinputdashboard").prop("disabled",!1),v.find("#letterinputdashboard").prop("disabled",!1)):(v.find("#methodeabcdcontainer").addClass("hide"),v.find("#serieinputdashboard").prop("disabled",!0),v.find("#letterinputdashboard").prop("disabled",!0))}),v.find("#serieinputdashboard").select2({allowClear:!0,placeholder:"Choisir une serie",tags:!0,cache:!0,ajax:{url:"parisabcd",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}),v.find("#letterinputdashboard").select2({allowClear:!0,placeholder:"Choisir une lettre",cache:!0,minimumResultsForSearch:1/0,ajax:{url:"lettreabcd",dataType:"json",data:function(e){return{serie_nom:$(k+" #serieinputdashboard").val(),q:e.term}},processResults:function(e){console.log(e);var a=[];return $.each(e,function(e,r){a.push({id:r,text:r})}),{results:a}}}}),v.find("#serieinputdashboard").change(function(){var e=$(k+"#serieinputdashboard option:selected").text();e=encodeURIComponent(e),v.find("#letterinputdashboard").val(null).trigger("change")})}function d(){C.find(".sportinputdashboard").select2({allowClear:!0,placeholder:"Choisir un sport",cache:!0,ajax:{url:"sports",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}).change(function(){V.html(""),T.val("").trigger("change"),B.val("").trigger("change"),q.val("").trigger("change"),V.val("").trigger("change"),A.val("").trigger("change"),H.val("").trigger("change"),K.val("").trigger("change"),Y.val("").trigger("change"),ae.val("").trigger("change"),oe.val("").trigger("change")})}function l(){C.find(".competitioninputdashboard").select2({allowClear:!0,placeholder:"Choisir une competition",cache:!0,ajax:{url:"competitions",dataType:"json",data:function(e){return{sport_id:C.find(".sportinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}})}function u(){C.find(".marketinputdashboard").select2({allowClear:!0,placeholder:"Choisir un type de pari",cache:!0,ajax:{url:"markets",dataType:"json",data:function(e){return{sport_id:C.find(".sportinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}}).change(function(){h(),b();var e=C.find(".marketinputdashboard").val();""==e?(F.fadeOut().addClass("hidden"),G.fadeOut().addClass("hidden")):(F.fadeIn().removeClass("hidden"),G.fadeIn().removeClass("hidden")),7==e?(V.select2({tags:!0,allowClear:!0,placeholder:"Nom de l'équipe ou du joueur vainqueur"}),J.html("Vainqueur <span class='glyphicon glyphicon-save'></span>")):8==e?(A.html('<option value=""></option>').val("").trigger("change").prop("disabled",!1),H.html('<option value=""></option>').val("").trigger("change").prop("disabled",!1),G.fadeIn().removeClass("hidden"),picks=[{id:"Home",text:"Domicile"},{id:"Away",text:"Exterieur"},{id:"Draw",text:"Match Nul"}],V.select2({data:picks,minimumResultsForSearch:1/0}),J.html("Résultat du match"),se.text("Equipe Handicap"),ne.fadeIn().removeClass("hidden"),ne.addClass("col-md-6"),participantNameList=[{id:"Home",text:"Domicile"},{id:"Away",text:"Exterieur"}],oe.select2({data:participantNameList,minimumResultsForSearch:1/0,placeholder:"Equipe/Joueur"}),U.html('Handicap <span class="glyphicon glyphicon-save"></span>'),W.fadeIn().removeClass("hidden"),W.addClass("col-md-6"),K.html('<option value=""></option>'),K.select2({tags:!0,allowClear:!0,placeholder:"2.5 ou -2.5"})):9==e?(picks=[{id:"1X",text:"1X"},{id:"X2",text:"X2"},{id:"12",text:"12"}],V.select2({data:picks,minimumResultsForSearch:1/0}),A.html('<option value=""></option>').val("").trigger("change").prop("disabled",!1),H.html('<option value=""></option>').val("").trigger("change").prop("disabled",!1),J.html("Choix")):43==e?(I.removeClass("hidden"),M.removeClass("hidden"),picks=[{id:"Home",text:"Home"},{id:"Away",text:"Away"},{id:"Draw",text:"Draw"}],V.select2({data:picks,minimumResultsForSearch:1/0})):46==e?(I.removeClass("hidden"),M.removeClass("hidden"),picks=[{id:"Home",text:"Home"},{id:"Away",text:"Away"}],V.select2({data:picks,minimumResultsForSearch:1/0})):48==e?(I.removeClass("hidden"),M.removeClass("hidden"),picks=[{id:"Home",text:"Home"},{id:"Away",text:"Away"}],V.select2({data:picks,minimumResultsForSearch:1/0}),W.removeClass("hidden"),U.text("Handicap"),K.select2({placeholder:"-2.5 ou 2.5",tags:!0})):(C.find(".pickinputdashboard").html(""),C.find(".pickinputdashboard").val("").trigger("change"))})}function c(){C.find(".scopeinputdashboard").select2({allowClear:!0,placeholder:"Choisir une portée",cache:!0,ajax:{url:"scopes",dataType:"json",data:function(e){return{sport_id:C.find(".sportinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}})}function p(){C.find(".pickinputdashboard").select2()}function m(){C.find(".team1inputdashboard").select2({allowClear:!0,placeholder:"Equipe/Joueur Domicile",cache:!0,ajax:{url:"equipes",dataType:"json",data:function(e){return{sport_id:C.find(".sportinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}}),C.find(".team2inputdashboard").select2({allowClear:!0,placeholder:"Equipe/Joueur Exterieur",cache:!0,ajax:{url:"equipes",dataType:"json",data:function(e){return{sport_id:C.find(".sportinputdashboard").val(),q:e.term}},processResults:function(e){return{results:e}}}})}function f(){C.submit(function(e){e.preventDefault();var a,t=C.serialize();a=C.find("#live").is(":checked")?1:0,$.ajax({url:"manualcoupon",type:"post",data:t+"&live="+a,success:function(e){0==e.etat?(e.errors.date?(C.find("#date_container").addClass("has-error"),C.find("#date_error").html(e.errors.date)):(C.find("#date_container").removeClass("has-error"),C.find("#date_error").empty()),e.errors.sport?(C.find("#sport_container").addClass("has-error"),C.find("#sport_error").html(e.errors.sport)):(C.find("#sport_container").removeClass("has-error"),C.find("#sport_error").empty()),e.errors.competition?(C.find("#competition_container").addClass("has-error"),C.find("#competition_error").html(e.errors.competition)):(C.find("#competition_container").removeClass("has-error"),C.find("#competition_error").empty()),e.errors.market?(C.find("#market_container").addClass("has-error"),C.find("#market_error").html(e.errors.market)):(C.find("#market_container").removeClass("has-error"),C.find("#market_error").empty()),e.errors.scope?(C.find("#scope_container").addClass("has-error"),C.find("#scope_error").html(e.errors.scope)):(C.find("#scope_container").removeClass("has-error"),C.find("#scope_error").empty()),e.errors.team1?(C.find("#team1_container").addClass("has-error"),C.find("#team1_error").html(e.errors.team1)):(C.find("#team1_container").removeClass("has-error"),C.find("#team1_error").empty()),e.errors.team2?(C.find("#team2_container").addClass("has-error"),C.find("#team2_error").html(e.errors.team2)):(C.find("#team2_container").removeClass("has-error"),C.find("#team2_error").empty()),e.errors.pick?(C.find("#pick_container").addClass("has-error"),C.find("#pick_error").html(e.errors.pick)):(C.find("#pick_container").removeClass("has-error"),C.find("#pick_error").empty()),e.errors.odd_doubleParam?(C.find("#odd_doubleParam_container").addClass("has-error"),C.find("#odd_doubleParam_error").html(e.errors.odd_doubleParam)):(C.find("#odd_doubleParam_container").removeClass("has-error"),C.find("#odd_doubleParam_error").empty()),e.errors.odd_doubleParam2?(C.find("#odd_doubleParam2_container").addClass("has-error"),C.find("#odd_doubleParam2_error").html(e.errors.odd_doubleParam2)):(C.find("#odd_doubleParam2_container").removeClass("has-error"),C.find("#odd_doubleParam2_error").empty()),e.errors.odd_doubleParam3?(C.find("#odd_doubleParam3_container").addClass("has-error"),C.find("#odd_doubleParam3_error").html(e.errors.odd_doubleParam3)):(C.find("#odd_doubleParam3_container").removeClass("has-error"),C.find("#odd_doubleParam3_error").empty()),e.errors.bookmaker?(C.find("#bookmaker_container").addClass("has-error"),C.find("#bookmaker_error").html(e.errors.bookmaker)):(C.find("#bookmaker_container").removeClass("has-error"),C.find("#bookmaker_error").empty()),e.errors.odd_value?(C.find("#odd_container").addClass("has-error"),C.find("#odd_error").html(e.errors.odd_value)):(C.find("#odd_container").removeClass("has-error"),C.find("#odd_error").empty())):(r(),_.modal("hide"))}})})}function h(){q.html("").val("").trigger("change"),F.addClass("hidden"),F.removeClass("has-error"),O.empty(),V.html("").val("").trigger("change"),G.addClass("hidden"),G.removeClass("has-error"),X.empty(),K.html("").val("").trigger("change"),W.addClass("hidden"),W.removeClass("has-error"),Q.empty(),Y.html("").val("").trigger("change"),Z.addClass("hidden"),Z.removeClass("has-error"),ee.empty(),ae.html("").val("").trigger("change"),re.addClass("hidden"),re.removeClass("has-error"),te.empty(),oe.html("").val("").trigger("change"),ne.addClass("hidden"),ne.removeClass("has-error"),ie.empty()}function b(){A.html("").val("").trigger("change").prop("disabled",!0),H.html("").val("").trigger("change").prop("disabled",!0)}function g(){$("#manualBetAddModal").on("hidden.bs.modal",function(){y.val(null).trigger("change"),x.removeClass("has-error"),w.empty(),P.val(null).trigger("change"),j.removeClass("has-error"),D.empty(),T.val(null).trigger("change"),N.removeClass("has-error"),R.empty(),B.val(null).trigger("change"),E.removeClass("has-error"),S.empty(),q.val(null).trigger("change"),F.removeClass("has-error"),O.empty(),A.val(null).trigger("change"),I.removeClass("has-error"),z.empty(),H.val(null).trigger("change"),M.removeClass("has-error"),L.empty(),V.val(null).trigger("change"),G.removeClass("has-error"),X.empty(),K.val(null).trigger("change"),W.removeClass("has-error"),Q.empty(),Y.val(null).trigger("change"),Z.removeClass("has-error"),ee.empty(),ae.val(null).trigger("change"),re.removeClass("has-error"),te.empty(),oe.val(null).trigger("change"),ne.removeClass("has-error"),ie.empty(),ce.val(null).trigger("change"),me.removeClass("has-error"),pe.empty(),le.val(null).trigger("change"),de.removeClass("has-error"),ue.empty(),le.val(null),ge.removeClass("has-error").addClass("hidden"),be.empty(),he.val(""),he.prop("disabled",!0),fe.prop("checked",!1)})}var v=$("#automaticform-add"),k="#automaticform-add",C=$("#manualselectionform-add"),_=$("#manualBetAddModal").modal("hide"),y=C.find('input[name="date"]'),x=C.find("#date_container"),w=C.find("#date_error"),P=C.find('select[name="sport"]'),j=C.find("#sport_container"),D=C.find("#sport_error"),T=C.find('select[name="competition"]'),N=C.find("#competition_container"),R=C.find("#competition_error"),B=C.find('select[name="market"]'),E=C.find("#market_container"),S=C.find("#market_error"),q=C.find('select[name="scope"]'),F=C.find("#scope_container"),O=C.find("#scope_error"),A=C.find('select[name="team1"]'),I=C.find("#team1_container"),z=C.find("#team1_error"),H=C.find('select[name="team2"]'),M=C.find("#team2_container"),L=C.find("#team2_error"),V=C.find('select[name="pick"]'),G=C.find("#pick_container"),J=G.find("label"),X=C.find("#pick_error"),K=C.find('select[name="odd_doubleParam"]'),W=C.find("#odd_doubleParam_container"),U=W.find("label"),Q=C.find("#odd_doubleParam_error"),Y=C.find('select[name="odd_doubleParam2"]'),Z=C.find("#odd_doubleParam2_container"),ee=C.find("#odd_doubleParam2_error"),ae=C.find('select[name="odd_doubleParam3"]'),re=C.find("#odd_doubleParam3_container"),te=C.find("#odd_doubleParam3_error"),oe=C.find('select[name="odd_participantParameterName"]'),ne=C.find("#odd_participantParameterName_container"),se=ne.find("label"),ie=C.find("#odd_participantParameterName_error"),de=C.find("#bookmaker_container"),le=C.find('select[name="bookmaker"]'),ue=C.find("#bookmaker_error"),ce=C.find('input[name="odd_value"]'),pe=C.find("#odd_error"),me=C.find("#odd_container"),fe=C.find("#live"),he=C.find('input[name="score"]'),be=C.find("#score_error"),ge=C.find("#score_container");le.select2({allowClear:!0,placeholder:"Choisir un bookmaker",cache:!0,ajax:{url:"bookmakers",dataType:"json",data:function(e){return{q:e.term}},processResults:function(e){return{results:e}}}}),e(),$.fn.modal.Constructor.prototype.enforceFocus=function(){},y.datetimepicker({format:"dd-mm-yyyy hh:ii",autoclose:!0,todayBtn:!0,language:"fr",pickerPosition:"bottom-left"}),g(),f(),t(),o(),n(),s(),i(),d(),l(),u(),c(),p(),m()}function calculProfits(e,a,r,t,o,n){var s,i,d=o,l=d,u=r,c=t,p=n,m=!1,f=!1,h=1,b="font-green-sharp",g="font-red-haze";if("simple"==e){var v=Number(u.find(".tdcote").text());0==a?s=1:1==a?h*=v:2==a?(h*=0,i=1):3==a?h*=[(v-1)/2+1]:4==a?h=.5*h:5==a&&(h+=0),s&&!i?(l="",m=!1,f=!0):(m=!0,l=h*d,l-=d,l=Number(Math.round(100*l)/100)),l>0?(c.addClass(b),p.addClass(b),c.removeClass(g),p.removeClass(g),c.removeClass("font-gray"),p.removeClass("font-gray")):0>l?(c.addClass(g),p.addClass(g),c.removeClass(b),p.removeClass(b),c.removeClass("font-gray"),p.removeClass("font-gray")):(c.addClass("font-gray"),p.addClass("font-gray"),c.removeClass(b),p.removeClass(b),c.removeClass(g),p.removeClass(g)),m?p.removeClass("hide"):p.addClass("hide"),l>0?f?c.html("+"+l):c.text("+"+l):f?c.html(l):c.text(l)}else u.find(".child-table-tr").each(function(){var e=Number($(this).find(".cote-td").text()),a=$(this).find('select[name="resultatSelectionDashboardInput[]"]').val();0==a?s=1:1==a?h*=e:2==a?(h*=0,i=1):3==a?h*=[(e-1)/2+1]:4==a?h=.5*h:5==a&&(h+=0)}),s&&!i?(l="",m=!1):(m=!0,l=h*d,l-=d,l=Number(Math.round(100*l)/100)),l>0?(c.addClass(b),p.addClass(b),c.removeClass(g),p.removeClass(g),c.removeClass("font-gray"),p.removeClass("font-gray")):0>l?(c.addClass(g),p.addClass(g),c.removeClass(b),p.removeClass(b),c.removeClass("font-gray"),p.removeClass("font-gray")):(c.addClass("font-gray"),p.addClass("font-gray"),c.removeClass(b),p.removeClass(b),c.removeClass(g),p.removeClass(g)),m?p.removeClass("hide"):p.addClass("hide"),c.text(l>0?"+"+l:l)}function statusBoutonValider(e,a,r){var t=a,o=r,n=new Array;if("simple"==e){var s=t.find('select[name="resultatSelectionDashboardInput[]"]').val();"0"==s?o.prop("disabled",!0):o.prop("disabled",!1)}else t.find(".child-table-tr").each(function(){var e=$(this).find('select[name="resultatSelectionDashboardInput[]"]').val();n.push(e)}),-1!==$.inArray("2",n)||-1==$.inArray("2",n)&&-1==$.inArray("0",n)?o.prop("disabled",!1):o.prop("disabled",!0)}function parisEnCoursCalculateStatus(e){$(e+" select[name='resultatSelectionDashboardInput[]']").change(function(){var a,r=($(e),
$(this).closest(".mainrow")),t=$(this).val(),o=$(this).parents().hasClass("subrow");if(a=o?"combine":"simple","simple"==a){var a=r.find(".type").text(),n=(r.find(".tdcote").text(),r.find(".tdsubmise").text()),s=r.find(".profits"),i=r.find(".devise"),d=r.find(".boutonvalider");statusBoutonValider(a,r,d),calculProfits(a,t,r,s,n,i)}else{var l=$(this).closest(".subrow"),u=l.prev(),a=u.find(".mainrow").text(),d=u.find(".boutonvalider"),c=$(this).closest(".child-table-tr"),n=(c.find(".child-id").text(),c.find('input[name="childrowsinput[]"]').val(),u.find(".tdsubmise").text()),s=u.find(".profits"),i=u.find(".devise");statusBoutonValider(a,l,d),calculProfits(a,"",l,s,n,i)}})}function parisEnCoursDelete(e,a,r){var t=($(e),$(a),r);$(e+" "+a).submit(function(e){e.preventDefault();{var a=$(this).closest(".mainrow"),r=a.find(".id").text();a.find(".tdretour span.subretour"),a.find(".tdcote").text(),a.find(".tdmise .tdsubmise").text(),$(this).serialize()}swal({title:"Supprimer le ticket",text:"Etes-vous sur?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui!",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&$.ajax({url:t+r,type:"delete",success:function(e){loadParisEnCours(),loadBookmakersOnDashboard(),0==e.etat?toastr.error(e.msg,"Suppression"):(toastr.success(e.msg,"Suppression"),loadBookmakersOnDashboard())},error:function(){console.log("supprimer un pari en cours ne fonctionne pas")}})})})}function parisEnCoursEnclose(e,a,r){var t=($(e),$(a),r);$(e+" "+a).submit(function(e){e.preventDefault();var a=$(this).closest(".mainrow"),r=($(this).closest(".wrapperRow"),a.find(".tdretour span.subretour"),a.find(".id").text()),o=[],n=[],s=(a.next().find(".child-row input"),a.find(".type").text());"simple"==s?(o=a.find('select[name="resultatSelectionDashboardInput[]"]').serialize(),n=a.find('input[name="childrowsinput[]"]').serialize()):(o=a.next().find('select[name="resultatSelectionDashboardInput[]"]').serialize(),n=a.next().find('input[name="childrowsinput[]"]').serialize()),$.ajax({url:t,type:"post",data:o+"&"+n+"&ticket-id="+r,dataType:"json",success:function(e){0==e.etat?toastr.error(e.msg,"Validation"):(toastr.success(e.msg,"Validation"),loadParisEnCours(),loadParisTermine(),loadBookmakersOnDashboard(),loadRecapsOnDashboard())},error:function(){console.log("valider un pari en cours ne fonctionne pas")}})})}function parisTermineDelete(){var e="#paristerminetable",a=".supprimerform",r="historique/";$(e+" "+a).submit(function(e){e.preventDefault();var a=$(this).closest(".mainrow"),t=a.find(".id").text();swal({title:"Supprimer le ticket",text:"Etes-vous sur?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui!",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&$.ajax({url:r+t,type:"delete",success:function(e){0==e.etat?toastr.error(e.msg,"Suppression"):(toastr.success(e.msg,"Suppression"),loadParisTermine(),loadBookmakersOnDashboard(),loadRecapsOnDashboard())},error:function(){console.log("supprimer un pari en cours ne fonctionne pas")}})})})}parisEnCoursDelete(),getBookmakersForSelection(),loadParisEnCours(),loadParisLongTerme(),loadParisABCD(),loadParisTermine(),loadRecapsOnDashboard(),loadBookmakersOnDashboard(),automaticBetForm(),manualBetForm(),$("#WelcomeModal").modal({keyboard:!1,backdrop:"static"});