function gestionTransactions(){function e(e){e=e||"1",$.ajax({url:"transaction",data:{page:e},success:function(e){$(g).html(e),getBookmakersForSelection(d,u)}})}function r(){$(g).on("click",".pagination a",function(r){r.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));e(t)})}function t(){$(a).on("hide.bs.modal",function(){n.find(s).removeClass("has-error"),n.find(c).removeClass("has-error"),n.find(f).removeClass("has-error"),n.find(v).removeClass("has-error"),n.find(_).removeClass("has-error"),n.find(i).empty(),n.find(m).empty(),n.find(l).empty(),n.find(h).empty(),n.find(C).empty(),n.find(o).val(null).trigger("change"),n.find(d).val(null).trigger("change"),n.find(u).val(null).trigger("change"),n.find(p).val(""),n.find(k).val("")}),n.submit(function(r){r.preventDefault(),$.ajax({url:"transaction",data:n.serialize(),type:"POST",dataType:"json",success:function(r){0==r.state?(r.errors.type?(n.find(s).addClass("has-error"),n.find(i).html(r.errors.type)):(n.find(s).removeClass("has-error"),n.find(i).empty()),r.errors.book?(n.find(c).addClass("has-error"),n.find(m).html(r.errors.book)):(n.find(c).removeClass("has-error"),n.find(m).empty()),r.errors.account?(n.find(f).addClass("has-error"),n.find(l).html(r.errors.account)):(n.find(f).removeClass("has-error"),n.find(l).empty()),r.errors.amount?(n.find(v).addClass("has-error"),n.find(h).html(r.errors.amount)):(n.find(v).removeClass("has-error"),n.find(h).empty()),r.errors.description?(n.find(_).addClass("has-error"),n.find(C).html(r.errors.description)):(n.find(_).removeClass("has-error"),n.find(C).empty())):(e(),$(a).modal("hide"),toastr.success("Le transactions à été crée avec <strong>succès</strong>!","Transaction"))}})})}var n=$("#transactionform-add"),a="#transactionAddModal",o='select[name="type"]',s="#type_container",i="#type_error",d='select[name="book"]',c="#book_container",m="#book_error",u='select[name="account"]',f="#account_container",l="#account_error",p='input[name="amount"]',v="#amount_container",h="#amount_error",k='input[name="description"]',_="#description_container",C="#description_error",g="#transactions-pagination";e(),t(),r()}function gestionBookmakers(){function e(e){e=e||"1",$.ajax({url:h,data:{page:e},success:function(e){$(v).html(e),a(),o()}})}function r(){$(v).on("click",".pagination a",function(r){r.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));e(t)})}function t(){var r=$("#bookmakerform-add");$("#bookmakerAddModal").on("hide.bs.modal",function(){r.find(i).removeClass("has-error"),r.find(m).removeClass("has-error"),r.find(l).removeClass("has-error"),r.find(d).empty(),r.find(u).empty(),r.find(p).empty(),r.find(s).val(""),r.find(c).val(""),r.find(f).val("")}),r.submit(function(t){var n=$(this).serialize();t.preventDefault(),$.ajax({url:"bookmaker",data:n,type:"post",dataType:"json",success:function(t){t.state?(e(),$("#bookmakerAddModal").modal("hide"),toastr.success("Compte ajouté","Compte de Bookmaker")):(t.errors.name_bookmaker?(r.find(i).addClass("has-error"),r.find(d).html(t.errors.name_bookmaker)):(r.find(i).removeClass("has-error"),r.find(d).empty()),t.errors.name_account?(r.find(m).addClass("has-error"),r.find(u).html(t.errors.name_account)):(r.find(m).removeClass("has-error"),r.find(u).empty()),t.errors.amount_bookmaker?(r.find(l).addClass("has-error"),r.find(p).html(t.errors.amount_bookmaker)):(r.find(l).removeClass("has-error"),r.find(p).empty()))}})})}function n(){var r=$("#bookmakerform-edit");r.submit(function(t){t.preventDefault();var n=$(this).find("#idAccountEditInput").val();$.ajax({url:"bookmaker/"+n,method:"PUT",data:$(this).serialize(),dataType:"json",success:function(t){t.state?(e(),toastr.success("Compte mis à jour avec <strong>succes</strong> !","Compte de Bookmaker"),$("#bookmakerEditModal").modal("hide")):t.errors.name_account?(r.find(m).addClass("has-error"),r.find(u).html(t.errors.name_account)):(r.find(m).removeClass("has-error"),r.find(u).empty())}})})}function a(){var e=$("#bookmakerform-edit");$(".bookmakerEditButton").click(function(){e.find("#idBookmakerEditInput").val($(this).attr("data-id-bookmaker")),e.find("#idAccountEditInput").val($(this).attr("data-id")),e.find(c).val($(this).attr("data-name"))})}function o(){$(".bookmakerDeleteButton").click(function(r){r.preventDefault();var t=$(this).parents("tr"),n=t.find(".idbookmakertd").text();console.log(n),swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(r){r&&$.ajax({url:"bookmaker/"+n,method:"DELETE",dataType:"json",success:function(r){r.state?(toastr.success("Le compte "+r.compte.nom_compte+" à été supprimé avec succès!","Compte de bookmaker"),e()):swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce compte.","error")}})})})}var s="select[name='name_bookmaker']",i="#bookmaker_container",d="#bookmaker_error",c="input[name='name_account']",m="#account_container",u="#account_error",f="input[name='amount_bookmaker']",l="#amount_container",p="#amount_error",v="#bookmakers-pagination",h="pagination/ajax/bookmakers";e(),r(),t(),n()}function gestionTipsters(){function e(e){var r=e||1;$.ajax({url:"pagination/ajax/tipsters",data:{page:r},type:"get",success:function(e){$(k).html(e),n(),o()}})}function r(){$(k).on("click",".pagination a",function(r){r.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));e(t)})}function t(){var r=$("#tipsterform-add");r.submit(function(t){t.preventDefault();r.find("#name_tipster"),r.find("#amount_tipster"),r.find("#suivi_tipster"),r.find("#nameinputerror"),r.find("#unitnumberinputerror"),r.find("#followtypeselecterror");$("#tipsterAddModal").on("hide.bs.modal",function(){r.find("#name_container").removeClass("has-error"),r.find("#amount_container").removeClass("has-error"),r.find("#suivi_container").removeClass("has-error"),r.find("#name_error").empty(),r.find("#amount_error").empty(),r.find("#suivi_error").empty(),r.find(s).val(""),r.find(f).val(""),r.find(c).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster",data:$("#tipsterform-add").serialize(),type:"POST",dataType:"json",success:function(t){0==t.success?(t.errors.name_tipster?(r.find("#name_container").addClass("has-error"),r.find("#name_error").html(t.errors.name_tipster)):(r.find("#name_container").removeClass("has-error"),r.find("#name_error").empty()),t.errors.amount_tipster?(r.find("#amount_container").addClass("has-error"),r.find("#amount_error").html(t.errors.amount_tipster)):(r.find("#amount_container").removeClass("has-error"),r.find("#amount_error").empty()),t.errors.suivi_tipster?(r.find("#suivi_container").addClass("has-error"),r.find("#suivi_error").html(t.errors.suivi_tipster)):(r.find("#suivi_container").removeClass("has-error"),r.find("#suivi_error").empty())):(e(),toastr.success("Le tipster à été crée avec <strong>succès</strong>!","Tipster"),$("#tipsterAddModal").modal("hide"))}})})}function n(){var e=$("#tipsterform-edit");$(".tipsterEditButton").click(function(){var r=$(this).attr("data-suivi");e.find(v).val($(this).attr("data-id")),e.find(s).val($(this).attr("data-name")),e.find(f).val($(this).attr("data-mt")),e.find(c+' option[value="'+r+'"]').prop("selected",!0)})}function a(){var r=$("#tipsterform-edit");r.submit(function(t){t.preventDefault();var n=$(this).find(v).val(),a=$(this).serialize();$("#tipsterEditModal").on("hide.bs.modal",function(){r.find(i).removeClass("has-error"),r.find(l).removeClass("has-error"),r.find(m).removeClass("has-error"),r.find(d).empty(),r.find(u).empty(),r.find(p).empty(),r.find(s).val(""),r.find(f).val(""),r.find(c).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster/"+n,method:"PUT",data:a,dataType:"json",success:function(t){t.state?(e(),toastr.success("Le tipster à été modifié avec <strong>succès</strong>!","Tipster"),$("#tipsterEditModal").modal("hide")):(t.errors.name_tipster?(r.find(i).addClass("has-error"),r.find(d).html(t.errors.name_tipster)):(r.find(i).removeClass("has-error"),r.find(d).empty()),t.errors.amount_tipster?(r.find(l).addClass("has-error"),r.find(p).html(t.errors.amount_tipster)):(r.find(l).removeClass("has-error"),r.find(p).empty()),t.errors.suivi_tipster?(r.find(m).addClass("has-error"),r.find(u).html(t.errors.suivi_tipster)):(r.find(m).removeClass("has-error"),r.find(u).empty()))}})})}function o(){$("#tipsterstable").on("click",".tipsterDeleteButton",function(r){r.preventDefault();var t=$(this).parents("tr"),n=t.find(h).text(),a="tipster/"+n;swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(r){if(r){$.ajax({url:a,method:"DELETE",dataType:"json",success:function(r){1==r.state?(toastr.success("supprimé avec <strong>succès</strong> !","Tipster"),e()):2==r.state?swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce tipster.","error"):0==r.state&&swal("Attention!","Ce tipster n'existe pas","error")}})}})})}var s="input[name='name_tipster']",i="#name_container",d="#name_error",c="select[name='suivi_tipster']",m="#suivi_container",u="#suivi_error",f="input[name='amount_tipster']",l="#amount_container",p="#amount_error",v="input[name='id']",h=".idtipstertd",k="#tipsters-pagination";e(),t(),a(),r()}gestionTipsters(),gestionBookmakers(),gestionTransactions();