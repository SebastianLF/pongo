function gestionBookmakers(){function r(r){r=r||"1",$.ajax({url:h,data:{page:r},success:function(r){$(v).html(r),n(),o()}})}function e(){$(v).on("click",".pagination a",function(e){e.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));r(t)})}function t(){var e=$("#bookmakerform-add");$("#bookmakerAddModal").on("hide.bs.modal",function(){e.find(i).removeClass("has-error"),e.find(m).removeClass("has-error"),e.find(f).removeClass("has-error"),e.find(c).empty(),e.find(u).empty(),e.find(p).empty(),e.find(s).val(""),e.find(d).val(""),e.find(l).val("")}),e.submit(function(t){var a=$(this).serialize();t.preventDefault(),$.ajax({url:"bookmaker",data:a,type:"post",dataType:"json",success:function(t){t.state?(r(),$("#bookmakerAddModal").modal("hide"),toastr.success("Compte ajouté","Compte de Bookmaker")):(t.errors.name_bookmaker?(e.find(i).addClass("has-error"),e.find(c).html(t.errors.name_bookmaker)):(e.find(i).removeClass("has-error"),e.find(c).empty()),t.errors.name_account?(e.find(m).addClass("has-error"),e.find(u).html(t.errors.name_account)):(e.find(m).removeClass("has-error"),e.find(u).empty()),t.errors.amount_bookmaker?(e.find(f).addClass("has-error"),e.find(p).html(t.errors.amount_bookmaker)):(e.find(f).removeClass("has-error"),e.find(p).empty()))}})})}function a(){var e=$("#bookmakerform-edit");e.submit(function(t){t.preventDefault();var a=$(this).find("#idAccountEditInput").val();$.ajax({url:"bookmaker/"+a,method:"PUT",data:$(this).serialize(),dataType:"json",success:function(t){t.state?(r(),toastr.success("Compte mis à jour avec <strong>succes</strong> !","Compte de Bookmaker"),$("#bookmakerEditModal").modal("hide")):t.errors.name_account?(e.find(m).addClass("has-error"),e.find(u).html(t.errors.name_account)):(e.find(m).removeClass("has-error"),e.find(u).empty())}})})}function n(){var r=$("#bookmakerform-edit");$(".bookmakerEditButton").click(function(){r.find("#idBookmakerEditInput").val($(this).attr("data-id-bookmaker")),r.find("#idAccountEditInput").val($(this).attr("data-id")),r.find(d).val($(this).attr("data-name"))})}function o(){$(".bookmakerDeleteButton").click(function(e){e.preventDefault();var t=$(this).parents("tr"),a=t.find(".idbookmakertd").text();console.log(a),swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&$.ajax({url:"bookmaker/"+a,method:"DELETE",dataType:"json",success:function(e){e.state?(toastr.success("Le compte "+e.compte.nom_compte+" à été supprimé avec succès!","Compte de bookmaker"),r()):swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce compte.","error")}})})})}var s="select[name='name_bookmaker']",i="#bookmaker_container",c="#bookmaker_error",d="input[name='name_account']",m="#account_container",u="#account_error",l="input[name='amount_bookmaker']",f="#amount_container",p="#amount_error",v="#bookmakers-pagination",h="pagination/ajax/bookmakers";r(),e(),t(),a()}function gestionTipsters(){function r(r){var e=r||1;$.ajax({url:"pagination/ajax/tipsters",data:{page:e},type:"get",success:function(r){$(C).html(r),a(),o()}})}function e(){$(C).on("click",".pagination a",function(e){e.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));r(t)})}function t(){var e=$("#tipsterform-add");e.submit(function(t){t.preventDefault();e.find("#name_tipster"),e.find("#amount_tipster"),e.find("#suivi_tipster"),e.find("#nameinputerror"),e.find("#unitnumberinputerror"),e.find("#followtypeselecterror");$("#tipsterAddModal").on("hide.bs.modal",function(){e.find("#name_container").removeClass("has-error"),e.find("#amount_container").removeClass("has-error"),e.find("#suivi_container").removeClass("has-error"),e.find("#name_error").empty(),e.find("#amount_error").empty(),e.find("#suivi_error").empty(),e.find(s).val(""),e.find(l).val(""),e.find(d).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster",data:$("#tipsterform-add").serialize(),type:"POST",dataType:"json",success:function(t){0==t.success?(t.errors.name_tipster?(e.find("#name_container").addClass("has-error"),e.find("#name_error").html(t.errors.name_tipster)):(e.find("#name_container").removeClass("has-error"),e.find("#name_error").empty()),t.errors.amount_tipster?(e.find("#amount_container").addClass("has-error"),e.find("#amount_error").html(t.errors.amount_tipster)):(e.find("#amount_container").removeClass("has-error"),e.find("#amount_error").empty()),t.errors.suivi_tipster?(e.find("#suivi_container").addClass("has-error"),e.find("#suivi_error").html(t.errors.suivi_tipster)):(e.find("#suivi_container").removeClass("has-error"),e.find("#suivi_error").empty())):(r(),toastr.success("Le tipster à été crée avec <strong>succès</strong>!","Tipster"),$("#tipsterAddModal").modal("hide"))}})})}function a(){var r=$("#tipsterform-edit");$(".tipsterEditButton").click(function(){var e=$(this).attr("data-suivi");r.find(v).val($(this).attr("data-id")),r.find(s).val($(this).attr("data-name")),r.find(l).val($(this).attr("data-mt")),r.find(d+' option[value="'+e+'"]').prop("selected",!0)})}function n(){var e=$("#tipsterform-edit");e.submit(function(t){t.preventDefault();var a=$(this).find(v).val(),n=$(this).serialize();$("#tipsterEditModal").on("hide.bs.modal",function(){e.find(i).removeClass("has-error"),e.find(f).removeClass("has-error"),e.find(m).removeClass("has-error"),e.find(c).empty(),e.find(u).empty(),e.find(p).empty(),e.find(s).val(""),e.find(l).val(""),e.find(d).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster/"+a,method:"PUT",data:n,dataType:"json",success:function(t){t.state?(r(),toastr.success("Le tipster à été modifié avec <strong>succès</strong>!","Tipster"),$("#tipsterEditModal").modal("hide")):(t.errors.name_tipster?(e.find(i).addClass("has-error"),e.find(c).html(t.errors.name_tipster)):(e.find(i).removeClass("has-error"),e.find(c).empty()),t.errors.amount_tipster?(e.find(f).addClass("has-error"),e.find(p).html(t.errors.amount_tipster)):(e.find(f).removeClass("has-error"),e.find(p).empty()),t.errors.suivi_tipster?(e.find(m).addClass("has-error"),e.find(u).html(t.errors.suivi_tipster)):(e.find(m).removeClass("has-error"),e.find(u).empty()))}})})}function o(){$("#tipsterstable").on("click",".tipsterDeleteButton",function(e){e.preventDefault();var t=$(this).parents("tr"),a=t.find(h).text(),n="tipster/"+a;swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(e){if(e){$.ajax({url:n,method:"DELETE",dataType:"json",success:function(e){1==e.state?(toastr.success("supprimé avec <strong>succès</strong> !","Tipster"),r()):2==e.state?swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce tipster.","error"):0==e.state&&swal("Attention!","Ce tipster n'existe pas","error")}})}})})}var s="input[name='name_tipster']",i="#name_container",c="#name_error",d="select[name='suivi_tipster']",m="#suivi_container",u="#suivi_error",l="input[name='amount_tipster']",f="#amount_container",p="#amount_error",v="input[name='id']",h=".idtipstertd",C="#tipsters-pagination";r(),t(),n(),e()}function loadTransactions(r){r=r||"1",$.ajax({url:"pagination/ajax/transactions",data:{page:r},type:"get",success:function(r){$("#transactions-pagination").html(r),getBookmakersForSelection("#transactionform-add #booknametransselect","#transactionform-add #accountnametransselect")},error:function(){console.log("le chargement des transactions n'a pas fonctionné")}})}function gestionTransactions(){}gestionTipsters(),gestionBookmakers(),gestionTransactions(),$(function(){$("#depotAddButton").click(function(){$("#typetransinput").val("depot"),$("#amountTransactionContainer").removeClass("has-error"),$("#booknameTransContainer").removeClass("has-error"),$("#accountnameTransContainer").removeClass("has-error"),$("#describeTransContainer").removeClass("has-error")}),$("#retraitAddButton").click(function(){$("#typetransinput").val("retrait"),$("#amountTransactionContainer").removeClass("has-error"),$("#booknameTransContainer").removeClass("has-error"),$("#accountnameTransContainer").removeClass("has-error"),$("#describeTransContainer").removeClass("has-error")}),$("#bonusAddButton").click(function(){$("#typetransinput").val("bonus"),$("#amountTransactionContainer").removeClass("has-error"),$("#booknameTransContainer").removeClass("has-error"),$("#accountnameTransContainer").removeClass("has-error"),$("#describeTransContainer").removeClass("has-error")});$("#transactionAddModal");$("#transactionform-add").submit(function(r){r.preventDefault(),$.ajax({url:"transaction",type:"post",data:$(this).serialize(),dataType:"json",success:function(r){if(r.success)loadTransactions(),loadBookmakers(),toastr.success("transaction crée avec succès","Transaction");else{var e="<ul>";r.errors.amounttransinput?$("#amountTransactionContainer").addClass("has-error"):$("#amountTransactionContainer").removeClass("has-error"),r.errors.booknametransselect?$("#booknameTransContainer").addClass("has-error"):$("#booknameTransContainer").removeClass("has-error"),r.errors.accountnametransselect?$("#accountnameTransContainer").addClass("has-error"):$("#accountnameTransContainer").removeClass("has-error"),r.errors.describetranstext?$("#describeTransContainer").addClass("has-error"):$("#describeTransContainer").removeClass("has-error"),r.errors.retraitNonDispo,$.each(r.errors,function(r,t){e+="<li>"+t+"</li>"}),e+="</ul>",toastr.error(e,"Transaction non ajouté")}}})})});