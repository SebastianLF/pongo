function loadBookmakers(r){r=r||"1",$.ajax({url:"pagination/ajax/bookmakers",data:{page:r},success:function(r){$("#bookmakers-pagination").html(r),editBookmakerButton(),deleteBookmakerButton()}})}function editBookmakerButton(){var r=$("#bookmakerform-edit");$(".bookmakerEditButton").click(function(){r.find("#idBookmakerEditInput").val($(this).attr("data-id-bookmaker")),r.find("#idAccountEditInput").val($(this).attr("data-id")),r.find(nameAccountInput).val($(this).attr("data-name"))})}function deleteBookmakerButton(){$(".bookmakerDeleteButton").click(function(r){r.preventDefault();var e=$(this).parents("tr"),t=e.find(".idbookmakertd").text();console.log(t),swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(r){r&&$.ajax({url:"bookmaker/"+t,method:"DELETE",dataType:"json",success:function(r){r.state?(toastr.success("Le compte "+r.compte.nom_compte+" à été supprimé avec succès!","Compte de bookmaker"),loadBookmakers()):swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce compte.","error")}})})})}function gestionBookmakers(){function r(){$(f).on("click",".pagination a",function(r){r.preventDefault();var e=getPaginationSelectedPage($(this).attr("href"));loadBookmakers(e)})}function e(){var r=$("#bookmakerform-add");$("#bookmakerAddModal").on("hide.bs.modal",function(){r.find(a).removeClass("has-error"),r.find(i).removeClass("has-error"),r.find(c).removeClass("has-error"),r.find(n).empty(),r.find(d).empty(),r.find(u).empty(),r.find(o).val(""),r.find(s).val(""),r.find(m).val("")}),r.submit(function(e){var t=$(this).serialize();e.preventDefault(),$.ajax({url:"bookmaker",data:t,type:"post",dataType:"json",success:function(e){e.state?(loadBookmakers(),$("#bookmakerAddModal").modal("hide"),toastr.success("Compte ajouté","Compte de Bookmaker")):(e.errors.name_bookmaker?(r.find(a).addClass("has-error"),r.find(n).html(e.errors.name_bookmaker)):(r.find(a).removeClass("has-error"),r.find(n).empty()),e.errors.name_account?(r.find(i).addClass("has-error"),r.find(d).html(e.errors.name_account)):(r.find(i).removeClass("has-error"),r.find(d).empty()),e.errors.amount_bookmaker?(r.find(c).addClass("has-error"),r.find(u).html(e.errors.amount_bookmaker)):(r.find(c).removeClass("has-error"),r.find(u).empty()))}})})}function t(){var r=$("#bookmakerform-edit");r.submit(function(e){e.preventDefault();var t=$(this).find("#idAccountEditInput").val();$.ajax({url:"bookmaker/"+t,method:"PUT",data:$(this).serialize(),dataType:"json",success:function(e){e.state?(loadBookmakers(),toastr.success("Compte mis à jour avec <strong>succes</strong> !","Compte de Bookmaker"),$("#bookmakerEditModal").modal("hide")):e.errors.name_account?(r.find(i).addClass("has-error"),r.find(d).html(e.errors.name_account)):(r.find(i).removeClass("has-error"),r.find(d).empty())}})})}var o="select[name='name_bookmaker']",a="#bookmaker_container",n="#bookmaker_error",s="input[name='name_account']",i="#account_container",d="#account_error",m="input[name='amount_bookmaker']",c="#amount_container",u="#amount_error",f="#bookmakers-pagination";loadBookmakers(),r(),e(),t()}function gestionTipsters(){function r(r){var e=r||1;$.ajax({url:"pagination/ajax/tipsters",data:{page:e},type:"get",success:function(r){$(k).html(r),o(),n()}})}function e(){$(k).on("click",".pagination a",function(e){e.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));r(t)})}function t(){var e=$("#tipsterform-add");e.submit(function(t){t.preventDefault();e.find("#name_tipster"),e.find("#amount_tipster"),e.find("#suivi_tipster"),e.find("#nameinputerror"),e.find("#unitnumberinputerror"),e.find("#followtypeselecterror");$("#tipsterAddModal").on("hide.bs.modal",function(){e.find("#name_container").removeClass("has-error"),e.find("#amount_container").removeClass("has-error"),e.find("#suivi_container").removeClass("has-error"),e.find("#name_error").empty(),e.find("#amount_error").empty(),e.find("#suivi_error").empty(),e.find(s).val(""),e.find(f).val(""),e.find(m).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster",data:$("#tipsterform-add").serialize(),type:"POST",dataType:"json",success:function(t){0==t.success?(t.errors.name_tipster?(e.find("#name_container").addClass("has-error"),e.find("#name_error").html(t.errors.name_tipster)):(e.find("#name_container").removeClass("has-error"),e.find("#name_error").empty()),t.errors.amount_tipster?(e.find("#amount_container").addClass("has-error"),e.find("#amount_error").html(t.errors.amount_tipster)):(e.find("#amount_container").removeClass("has-error"),e.find("#amount_error").empty()),t.errors.suivi_tipster?(e.find("#suivi_container").addClass("has-error"),e.find("#suivi_error").html(t.errors.suivi_tipster)):(e.find("#suivi_container").removeClass("has-error"),e.find("#suivi_error").empty())):(r(),toastr.success("Le tipster à été crée avec <strong>succès</strong>!","Tipster"),$("#tipsterAddModal").modal("hide"))}})})}function o(){var r=$("#tipsterform-edit");$(".tipsterEditButton").click(function(){var e=$(this).attr("data-suivi");r.find(h).val($(this).attr("data-id")),r.find(s).val($(this).attr("data-name")),r.find(f).val($(this).attr("data-mt")),r.find(m+' option[value="'+e+'"]').prop("selected",!0)})}function a(){var e=$("#tipsterform-edit");e.submit(function(t){t.preventDefault();var o=$(this).find(h).val(),a=$(this).serialize();$("#tipsterEditModal").on("hide.bs.modal",function(){e.find(i).removeClass("has-error"),e.find(l).removeClass("has-error"),e.find(c).removeClass("has-error"),e.find(d).empty(),e.find(u).empty(),e.find(p).empty(),e.find(s).val(""),e.find(f).val(""),e.find(m).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster/"+o,method:"PUT",data:a,dataType:"json",success:function(t){t.state?(r(),toastr.success("Le tipster à été modifié avec <strong>succès</strong>!","Tipster"),$("#tipsterEditModal").modal("hide")):(t.errors.name_tipster?(e.find(i).addClass("has-error"),e.find(d).html(t.errors.name_tipster)):(e.find(i).removeClass("has-error"),e.find(d).empty()),t.errors.amount_tipster?(e.find(l).addClass("has-error"),e.find(p).html(t.errors.amount_tipster)):(e.find(l).removeClass("has-error"),e.find(p).empty()),t.errors.suivi_tipster?(e.find(c).addClass("has-error"),e.find(u).html(t.errors.suivi_tipster)):(e.find(c).removeClass("has-error"),e.find(u).empty()))}})})}function n(){$("#tipsterstable").on("click",".tipsterDeleteButton",function(e){e.preventDefault();var t=$(this).parents("tr"),o=t.find(v).text(),a="tipster/"+o;swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(e){if(e){$.ajax({url:a,method:"DELETE",dataType:"json",success:function(e){1==e.state?(toastr.success("supprimé avec <strong>succès</strong> !","Tipster"),r()):2==e.state?swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce tipster.","error"):0==e.state&&swal("Attention!","Ce tipster n'existe pas","error")}})}})})}var s="input[name='name_tipster']",i="#name_container",d="#name_error",m="select[name='suivi_tipster']",c="#suivi_container",u="#suivi_error",f="input[name='amount_tipster']",l="#amount_container",p="#amount_error",h="input[name='id']",v=".idtipstertd",k="#tipsters-pagination";r(),t(),a(),e()}function gestionTransactions(){function r(r){r=r||"1",$.ajax({url:"transaction",data:{page:r},success:function(r){o.html(r),getBookmakersForSelection(this.book,this.account)}})}function e(){o.on("click",".pagination a",function(e){e.preventDefault();var t=getPaginationSelectedPage($(this).attr("href"));r(t)})}function t(){var e=this.modal,t=this.form,o=this.typeContainer,a=this.bookContainer,n=this.accountContainer,s=this.amountContainer,i=this.descriptionContainer,d=this.typeError,m=this.bookError,c=this.accountError,u=this.amountError,f=this.descriptionError,l=this.type,p=this.book,h=this.account,v=this.amount,k=this.description;$(e).on("hide.bs.modal",function(){t.find(o).removeClass("has-error"),t.find(a).removeClass("has-error"),t.find(n).removeClass("has-error"),t.find(s).removeClass("has-error"),t.find(i).removeClass("has-error"),t.find(d).empty(),t.find(m).empty(),t.find(c).empty(),t.find(u).empty(),t.find(f).empty(),t.find(l).val(null).trigger("change"),t.find(p).val(null).trigger("change"),t.find(h).val(null).trigger("change"),t.find(v).val(""),t.find(k).val("")}),t.submit(function(l){l.preventDefault(),$.ajax({url:"transaction",data:t.serialize(),type:"POST",dataType:"json",success:function(l){0==l.state?(l.errors.type?(t.find(o).addClass("has-error"),t.find(d).html(l.errors.type)):(t.find(o).removeClass("has-error"),t.find(d).empty()),l.errors.book?(t.find(a).addClass("has-error"),t.find(m).html(l.errors.book)):(t.find(a).removeClass("has-error"),t.find(m).empty()),l.errors.account?(t.find(n).addClass("has-error"),t.find(c).html(l.errors.account)):(t.find(n).removeClass("has-error"),t.find(c).empty()),l.errors.amount?(t.find(s).addClass("has-error"),t.find(u).html(l.errors.amount)):(t.find(s).removeClass("has-error"),t.find(u).empty()),l.errors.description?(t.find(i).addClass("has-error"),t.find(f).html(l.errors.description)):(t.find(i).removeClass("has-error"),t.find(f).empty())):(r(),loadBookmakers(),$(e).modal("hide"),toastr.success("Le transactions à été crée avec <strong>succès</strong>!","Transaction"))}})})}var o=($("#transactionform-add"),$("#transactions-pagination"));r(),t(),e()}gestionTipsters(),gestionBookmakers();