function deleteBookmakerButton(){$(".bookmakerDeleteButton").click(function(o){o.preventDefault();var a=$(this).parents("tr"),r=a.find(".idbookmakertd").text();console.log(r),swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(o){o&&$.ajax({url:"bookmaker/"+r,method:"DELETE",data:{id:$("#idbookmakertd").text()},success:function(o){o.success?(toastr.success(o.compte.nom_compte+" à été supprimé avec succès","Compte de bookmaker"),loadBookmakers()):toastr.error("Vous devez d'abord supprimer les paris en cours liés à <strong>"+o.compte.nom_compte+"</strong> !","Compte de bookmaker")},error:function(){console.log("la suppression du compte bookmaker n'a pas fonctionné")}})})})}function editBookmakerButton(){$(".bookmakerEditButton").click(function(){$("#idBookmakerEditInput").val($(this).attr("data-id-bookmaker")),$("#idAccountEditInput").val($(this).attr("data-id")),$("#nameAccountEditInput").val($(this).attr("data-name"))})}function updateBookmaker(){$("#bookmakerform-edit").submit(function(o){o.preventDefault();var a=$(this).find("#idAccountEditInput").val();$.ajax({url:"bookmaker/"+a,method:"PUT",data:$(this).serialize(),dataType:"json",success:function(o){o.success?(loadBookmakers(),toastr.success("Compte mis à jour avec <strong>succes</strong> !","Compte Bookmaker"),$("#bookmakerEditModal").modal("hide")):($("#nameAccountEditContainer").addClass("has-error"),$("#nameAccountEditInput"),toastr.error("<ul><li>"+o.errors.nameAccountEditInput+"</li></ul>","Compte Bookmaker"))},error:function(o){console.log("impossible de mettre à jour le compte bookmaker")}})})}function loadBookmakers(o){o=o||"1",$.ajax({url:"pagination/ajax/bookmakers",data:{page:o},type:"get",success:function(o){$("#bookmakers-pagination").html(o),editBookmakerButton(),deleteBookmakerButton()},error:function(o){console.log("l'affichage des bookmakers n'a pas fonctionné")}})}function gestionTipsters(){function o(){$(r).on("click",".pagination a",function(o){o.preventDefault();var r=getPaginationSelectedPage($(this).attr("href"));a(r)})}function a(o){var a=o||1;$.ajax({url:"pagination/ajax/tipsters",data:{page:a},type:"get",success:function(o){$(r).html(o)}})}var r="#tipsters-pagination";a(),o()}function loadTransactions(o){o=o||"1",$.ajax({url:"pagination/ajax/transactions",data:{page:o},type:"get",success:function(o){$("#transactions-pagination").html(o),getBookmakersForSelection("#transactionform-add #booknametransselect","#transactionform-add #accountnametransselect")},error:function(){console.log("le chargement des transactions n'a pas fonctionné")}})}editBookmakerButton(),updateBookmaker(),gestionTipsters(),loadBookmakers(),loadTransactions(),$("#addBookmakerButton").click(function(){$("#bookmakerListOnBookmakerContainer").removeClass("has-error"),$("#accountNameBookmakerContainer").removeClass("has-error"),$("#bankrollAmountBookmakerContainer").removeClass("has-error")}),$("#bookmakerform-add").submit(function(o){var a=$(this).serialize();o.preventDefault(),$.ajax({url:"bookmaker",data:a,type:"post",dataType:"json",success:function(o){if(o.success)$("#bookmakerListOnBookmakerContainer").removeClass("has-error"),$("#accountNameBookmakerContainer").removeClass("has-error"),$("#bankrollInvestedBookmakerContainer").removeClass("has-error"),$("#bonusBookmakerContainer").removeClass("has-error"),$("#bankrollAmountBookmakerContainer").removeClass("has-error"),$("#accountnameinput").val(""),$("#bankrollinvestedinput").val(""),$("#bonusinput").val(""),$("#bankrollamountinput").val(""),loadBookmakers(),$("#bookmakerAddModal").modal("hide"),toastr.success("Compte ajouté","Compte Bookmaker");else{var a="<ul>";o.errors.booknameselect?$("#bookmakerListOnBookmakerContainer").addClass("has-error"):$("#bookmakerListOnBookmakerContainer").removeClass("has-error"),o.errors.accountnameinput?$("#accountNameBookmakerContainer").addClass("has-error"):$("#accountNameBookmakerContainer").removeClass("has-error"),o.errors.bankrollamountinput?$("#bankrollAmountBookmakerContainer").addClass("has-error"):$("#bankrollAmountBookmakerContainer").removeClass("has-error"),$.each(o.errors,function(o,r){a+="<li>"+r+"</li>"}),a+="</ul>",toastr.error(a,"Compte bookmaker non ajouté")}},error:function(o){console.log("fail:"+o)}})}),paginationOnclick("pagination/ajax/bookmakers","#bookmakers-pagination"),$(function(){$("#depotAddButton").click(function(){$("#typetransinput").val("depot"),$("#amountTransactionContainer").removeClass("has-error"),$("#booknameTransContainer").removeClass("has-error"),$("#accountnameTransContainer").removeClass("has-error"),$("#describeTransContainer").removeClass("has-error")}),$("#retraitAddButton").click(function(){$("#typetransinput").val("retrait"),$("#amountTransactionContainer").removeClass("has-error"),$("#booknameTransContainer").removeClass("has-error"),$("#accountnameTransContainer").removeClass("has-error"),$("#describeTransContainer").removeClass("has-error")}),$("#bonusAddButton").click(function(){$("#typetransinput").val("bonus"),$("#amountTransactionContainer").removeClass("has-error"),$("#booknameTransContainer").removeClass("has-error"),$("#accountnameTransContainer").removeClass("has-error"),$("#describeTransContainer").removeClass("has-error")});$("#transactionAddModal");$("#transactionform-add").submit(function(o){o.preventDefault(),$.ajax({url:"transaction",type:"post",data:$(this).serialize(),dataType:"json",success:function(o){if(o.success)loadTransactions(),loadBookmakers(),toastr.success("transaction crée avec succès","Transaction");else{var a="<ul>";o.errors.amounttransinput?$("#amountTransactionContainer").addClass("has-error"):$("#amountTransactionContainer").removeClass("has-error"),o.errors.booknametransselect?$("#booknameTransContainer").addClass("has-error"):$("#booknameTransContainer").removeClass("has-error"),o.errors.accountnametransselect?$("#accountnameTransContainer").addClass("has-error"):$("#accountnameTransContainer").removeClass("has-error"),o.errors.describetranstext?$("#describeTransContainer").addClass("has-error"):$("#describeTransContainer").removeClass("has-error"),o.errors.retraitNonDispo,$.each(o.errors,function(o,r){a+="<li>"+r+"</li>"}),a+="</ul>",toastr.error(a,"Transaction non ajouté")}},error:function(){}})})});