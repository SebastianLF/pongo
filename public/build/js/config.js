function Bookmakers(){var t="select[name='name_bookmaker']",e="#bookmaker_container",r="#bookmaker_error",o="input[name='name_account']",n="#account_container",a="#account_error",i="input[name='amount_bookmaker']",s="#amount_container",d="#amount_error",m="#bookmakers-pagination",c="pagination/ajax/bookmakers";this.loadBookmakers=function(t){t=t||"1",$.ajax({url:c,data:{page:t},success:function(t){$(m).html(t),this.editBookmakerButton(),this.deleteBookmakerButton()}})},this.paginationOnclick=function(){$(m).on("click",".pagination a",function(t){t.preventDefault();var e=getPaginationSelectedPage($(this).attr("href"));loadBookmakers(e)})},this.BookmakerAdd=function(){var m=$("#bookmakerform-add");$("#bookmakerAddModal").on("hide.bs.modal",function(){m.find(e).removeClass("has-error"),m.find(n).removeClass("has-error"),m.find(s).removeClass("has-error"),m.find(r).empty(),m.find(a).empty(),m.find(d).empty(),m.find(t).val(""),m.find(o).val(""),m.find(i).val("")}),m.submit(function(t){var o=$(this).serialize();t.preventDefault(),$.ajax({url:"bookmaker",data:o,type:"post",dataType:"json",success:function(t){t.state?(loadBookmakers(),$("#bookmakerAddModal").modal("hide"),toastr.success("Compte ajouté","Compte de Bookmaker")):(t.errors.name_bookmaker?(m.find(e).addClass("has-error"),m.find(r).html(t.errors.name_bookmaker)):(m.find(e).removeClass("has-error"),m.find(r).empty()),t.errors.name_account?(m.find(n).addClass("has-error"),m.find(a).html(t.errors.name_account)):(m.find(n).removeClass("has-error"),m.find(a).empty()),t.errors.amount_bookmaker?(m.find(s).addClass("has-error"),m.find(d).html(t.errors.amount_bookmaker)):(m.find(s).removeClass("has-error"),m.find(d).empty()))}})})},this.bookmakerUpdate=function(){var t=$("#bookmakerform-edit");t.submit(function(e){e.preventDefault();var r=$(this).find("#idAccountEditInput").val();$.ajax({url:"bookmaker/"+r,method:"PUT",data:$(this).serialize(),dataType:"json",success:function(e){e.state?(loadBookmakers(),toastr.success("Compte mis à jour avec <strong>succes</strong> !","Compte de Bookmaker"),$("#bookmakerEditModal").modal("hide")):e.errors.name_account?(t.find(n).addClass("has-error"),t.find(a).html(e.errors.name_account)):(t.find(n).removeClass("has-error"),t.find(a).empty())}})})},this.editBookmakerButton=function(){var t=$("#bookmakerform-edit");$(".bookmakerEditButton").click(function(){t.find("#idBookmakerEditInput").val($(this).attr("data-id-bookmaker")),t.find("#idAccountEditInput").val($(this).attr("data-id")),t.find(o).val($(this).attr("data-name"))})},this.deleteBookmakerButton=function(){$(".bookmakerDeleteButton").click(function(t){t.preventDefault();var e=$(this).parents("tr"),r=e.find(".idbookmakertd").text();console.log(r),swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(t){t&&$.ajax({url:"bookmaker/"+r,method:"DELETE",dataType:"json",success:function(t){t.state?(toastr.success("Le compte "+t.compte.nom_compte+" à été supprimé avec succès!","Compte de bookmaker"),loadBookmakers()):swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce compte.","error")}})})})},this.inits=function(){this.loadBookmakers(),this.paginationOnclick(),this.BookmakerAdd(),this.bookmakerUpdate()}}function gestionTipsters(){function t(t){var e=t||1;$.ajax({url:"pagination/ajax/tipsters",data:{page:e},type:"get",success:function(t){$(v).html(t),o(),a()}})}function e(){$(v).on("click",".pagination a",function(e){e.preventDefault();var r=getPaginationSelectedPage($(this).attr("href"));t(r)})}function r(){var e=$("#tipsterform-add");e.submit(function(r){r.preventDefault();e.find("#name_tipster"),e.find("#amount_tipster"),e.find("#suivi_tipster"),e.find("#nameinputerror"),e.find("#unitnumberinputerror"),e.find("#followtypeselecterror");$("#tipsterAddModal").on("hide.bs.modal",function(){e.find("#name_container").removeClass("has-error"),e.find("#amount_container").removeClass("has-error"),e.find("#suivi_container").removeClass("has-error"),e.find("#name_error").empty(),e.find("#amount_error").empty(),e.find("#suivi_error").empty(),e.find(i).val(""),e.find(l).val(""),e.find(m).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster",data:$("#tipsterform-add").serialize(),type:"POST",dataType:"json",success:function(r){0==r.success?(r.errors.name_tipster?(e.find("#name_container").addClass("has-error"),e.find("#name_error").html(r.errors.name_tipster)):(e.find("#name_container").removeClass("has-error"),e.find("#name_error").empty()),r.errors.amount_tipster?(e.find("#amount_container").addClass("has-error"),e.find("#amount_error").html(r.errors.amount_tipster)):(e.find("#amount_container").removeClass("has-error"),e.find("#amount_error").empty()),r.errors.suivi_tipster?(e.find("#suivi_container").addClass("has-error"),e.find("#suivi_error").html(r.errors.suivi_tipster)):(e.find("#suivi_container").removeClass("has-error"),e.find("#suivi_error").empty())):(t(),toastr.success("Le tipster à été crée avec <strong>succès</strong>!","Tipster"),$("#tipsterAddModal").modal("hide"))}})})}function o(){var t=$("#tipsterform-edit");$(".tipsterEditButton").click(function(){var e=$(this).attr("data-suivi");t.find(k).val($(this).attr("data-id")),t.find(i).val($(this).attr("data-name")),t.find(l).val($(this).attr("data-mt")),t.find(m+' option[value="'+e+'"]').prop("selected",!0)})}function n(){var e=$("#tipsterform-edit");e.submit(function(r){r.preventDefault();var o=$(this).find(k).val(),n=$(this).serialize();$("#tipsterEditModal").on("hide.bs.modal",function(){e.find(s).removeClass("has-error"),e.find(p).removeClass("has-error"),e.find(c).removeClass("has-error"),e.find(d).empty(),e.find(u).empty(),e.find(f).empty(),e.find(i).val(""),e.find(l).val(""),e.find(m).find('option[value="n"]').attr("selected",!0)}),$.ajax({url:"tipster/"+o,method:"PUT",data:n,dataType:"json",success:function(r){r.state?(t(),toastr.success("Le tipster à été modifié avec <strong>succès</strong>!","Tipster"),$("#tipsterEditModal").modal("hide")):(r.errors.name_tipster?(e.find(s).addClass("has-error"),e.find(d).html(r.errors.name_tipster)):(e.find(s).removeClass("has-error"),e.find(d).empty()),r.errors.amount_tipster?(e.find(p).addClass("has-error"),e.find(f).html(r.errors.amount_tipster)):(e.find(p).removeClass("has-error"),e.find(f).empty()),r.errors.suivi_tipster?(e.find(c).addClass("has-error"),e.find(u).html(r.errors.suivi_tipster)):(e.find(c).removeClass("has-error"),e.find(u).empty()))}})})}function a(){$("#tipsterstable").on("click",".tipsterDeleteButton",function(e){e.preventDefault();var r=$(this).parents("tr"),o=r.find(h).text(),n="tipster/"+o;swal({title:"Supprimer",text:"Etes vous sur ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler",closeOnConfirm:!0,closeOnCancel:!0},function(e){if(e){$.ajax({url:n,method:"DELETE",dataType:"json",success:function(e){1==e.state?(toastr.success("supprimé avec <strong>succès</strong> !","Tipster"),t()):2==e.state?swal("Attention!","Vous devez d'abord supprimer les tickets en cours liés à ce tipster.","error"):0==e.state&&swal("Attention!","Ce tipster n'existe pas","error")}})}})})}var i="input[name='name_tipster']",s="#name_container",d="#name_error",m="select[name='suivi_tipster']",c="#suivi_container",u="#suivi_error",l="input[name='amount_tipster']",p="#amount_container",f="#amount_error",k="input[name='id']",h=".idtipstertd",v="#tipsters-pagination";t(),r(),n(),e()}gestionTipsters();var GestionBookmakers=new Bookmakers;GestionBookmakers.inits();var Transactions={form:$("#transactionform-add"),addButton:"#transactionAddButton",modal:"#transactionAddModal",type:'select[name="type"]',typeContainer:"#type_container",typeError:"#type_error",book:'select[name="book"]',bookContainer:"#book_container",bookError:"#book_error",account:'select[name="account"]',accountContainer:"#account_container",accountError:"#account_error",amount:'input[name="amount"]',amountContainer:"#amount_container",amountError:"#amount_error",description:'input[name="description"]',descriptionContainer:"#description_container",descriptionError:"#description_error",paginationContainer:$("#transactions-pagination"),loadTransactions:function(t){t=t||"1";var e=this.paginationContainer;$.ajax({url:"transaction",data:{page:t},success:function(t){e.html(t),getBookmakersForSelection(this.book,this.account)}})}};Transactions.inits();